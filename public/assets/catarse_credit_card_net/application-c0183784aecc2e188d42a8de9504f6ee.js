(function(){window.CreditCardNetForm=Backbone.View.extend({el:".catarse-credit-card-net-form",initialize:function(){return _.bindAll(this,"validate","submit"),$(document).foundation("forms"),this.$button=this.$("input[type=submit]"),this.$form=this.$("form#credit-card-form"),this.$form.bind("submit",this.submit),this.showAuthorizeNetSeal()},submit:function(e){var r;return e.preventDefault(),this.validate()?(r={card_number:this.$("#card_number").val(),card_code:this.$("#card_code").val(),card_month:this.$("#card_month").val(),card_year:this.$("#card_year").val(),billing_first_name:this.$("#billing_first_name").val(),billing_last_name:this.$("#billing_last_name").val()},$.post(this.$form.prop("action"),r,function(e){return function(r){return("undefined"==typeof console||null===console)&&console.log(r),"ok"===r.process_status?location.href=$(".create-contribution-page").data("thank-you-path"):(e.$(".check-error p.error-name").text(r.message),e.$(".check-error").fadeIn(300),$.rails.enableFormElements(e.$form))}}(this),"json").error(function(){return this.$(".check-error p.error-name").text("The back already confirmed, if you can do another back please refresh the page or go back to project page :)"),this.$(".check-error").fadeIn(300)})):!1},validate:function(){var e;return e=!0,this.validateField(this.$("#billing_first_name"))||(e=!1),this.validateField(this.$("#billing_last_name"))||(e=!1),this.validateField(this.$("#card_number"))||(e=!1),this.validateField(this.$("#card_code"))||(e=!1),e},validateField:function(e){var r;return r=$.trim(this.replaceAll(e.val(),"_","")),r&&r.length>0?(this.removeError(e),!0):(this.addError(e),!1)},addError:function(e,r){return null==r&&(r="This field is required."),e.addClass("error"),e.parent().find("span.error").remove(),e[0].insertAdjacentHTML("afterend","<span class='error'>"+r+"</span>")},removeError:function(e){return e.removeClass("error"),e.parent().find("span.error").remove()},replaceAll:function(e,r,t){if(!(e&&e.length>0))return e;for(;-1!==e.indexOf(r);)e=e.replace(r,t);return e},showAuthorizeNetSeal:function(){return this.$(".AuthorizeNetSeal").html($(".seal-original .AuthorizeNetSeal").html())}})}).call(this),$(function(){new window.CreditCardNetForm});